# 系统引导时为什么要关闭Caches

在U-Boot和Linux的引导阶段都关闭了Caches，这是为什么呢？

Caches是CPU内部的一个2级缓存，它的作用是将常用的数据和指令放在CPU内部。Caches是通过CP15管理的，刚上电的时候，CPU还不能管理Caches。上电的时候指令Cache可关闭，也可不关闭，但数据Cache一定要关闭，否则可能导致刚开始的代码里面，去取数据的时候，从Cache里面取，而这时候RAM中数据还没有Cache过来，导致数据预取异常 。

说到Caches就必须提到一个关键字Volatile，以后在设置寄存器时会经常遇到。它的本质：是告诉编译器不要对我的代码进行优化，作用是让编写者感觉变量的变化情况。

优化的过程：是将常用的代码取出来放到Caches中，它没有从实际的物理地址去取，它直接从CPU的缓存中去取，但常用的代码就是为了感觉一些常用变量的变化

优化原因：如果正在取数据的时候发生跳变，那么就感觉不到变量的变化了，所以在这种情况下要用Volatile关键字告诉编译器不要做优化，每次从实际的物理地址中去取指令，这就是为什么关闭Caches的原因。

但在C语言中是不会关闭Caches，会打开，如果编写者要感觉外界变化，或变化太快，从Caches中取数据会有误差，就加一个关键字Volatile。
